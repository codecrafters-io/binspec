name: Kafka Produce Response (v11) - Unknown Topic
slug: kafka-produce-response-v11-unknown-topic
data:
  - 0x00 # Message length (4 bytes, 0x32 in hex, 50 in decimal)
  - 0x00
  - 0x00
  - 0x32
  - 0x00 # Correlation ID (4 bytes, 0x00000007 in hex, 7 in decimal)
  - 0x00
  - 0x00
  - 0x07
  - 0x00 # Empty tag buffer for Response Header
  - 0x02 # Topics array length + 1 (varint, 0x02 in hex, 2 in decimal)
  - 0x04 # Topic name length + 1 (varint, 0x04 in hex, 4 in decimal)
  - 0x71 # q (topic name)
  - 0x75 # u (topic name)
  - 0x7a # z (topic name)
  - 0x02 # Partitions array length + 1 (varint, 0x02 in hex, 2 in decimal)
  - 0x00 # Partition ID (4 bytes, 0x00000000 in hex, 0 in decimal)
  - 0x00
  - 0x00
  - 0x00
  - 0x00 # Error code (2 bytes, 0x0003 in hex, 3 in decimal => UNKNOWN_TOPIC_OR_PARTITION)
  - 0x03
  - 0xff # Base Offset (8 bytes, 0xffffffffffffffff in hex, -1 in decimal)
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff # Log Append Time in ms (8 bytes, 0xffffffffffffffff in hex, -1 in decimal)
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff # Log Start Offset (8 bytes, 0xffffffffffffffff in hex, -1 in decimal)
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0xff
  - 0x01 # Record Errors Array length + 1 (varint, 0x01 in hex, 1 in decimal)
  - 0x00 # Error Message as CompactNullableString (varint, 0x00 => null)
  - 0x00 # Empty tag buffer for Partition Response
  - 0x00 # Empty tag buffer for Topic Response
  - 0x00 # Throtte Time Ms (4 bytes, 0x00000000 in hex, 0 in decimal)
  - 0x00
  - 0x00
  - 0x00
  - 0x00 # Empty tag buffer for Response body
segments:
  - title: Message Size
    length_in_bytes: 4
    explanation_markdown: |
      Message Size is a 4-byte big-endian integer indicating the size of the rest of the message. All Kafka responses start with this field.

      In this case, the value is `0x32`, which is `50` in decimal, indicating that the rest of the message is 50 bytes long.
  - title: Response Header (v1)
    explanation_markdown: |
      The Response Header structure is common across all Kafka responses. It contains the Correlation ID that matches the request.
    children:
      - title: Correlation ID
        length_in_bytes: 4
        explanation_markdown: |
          The Correlation ID is a 4-byte integer that matches the ID sent in the corresponding request.

          Here, it is `0x07`, which is `7` in decimal.
      - title: Tag buffer
        length_in_bytes: 1
        explanation_markdown: |
          An empty tagged field array, represented by a single byte of value 0x00.
  - title: Produce Response Body (v11)
    explanation_markdown: |
      The response body contains fields specific to the Produce response.
    children:
      - title: Topic Responses Array
        explanation_markdown: |
          An array of topic responses.

          This array is encoded as a `COMPACT_ARRAY`, which starts with a varint corresponding to the length of the array + 1, followed by each element.
        children:
          - title: Array Length
            length_in_bytes: 1
            explanation_markdown: |
              The length of the topic responses array + 1, encoded as an unsigned varint. Here, it is `0x02`, which is `2` in decimal, meaning that the array length is 1.
          - title: "Topic #1"
            explanation_markdown: |
              A single topic in the array.
            children:
              - title: Topic Name
                explanation_markdown: |
                  The topic name encoded as a `COMPACT_STRING`, which starts with a varint corresponding to the length of the string + 1, followed by the string itself encoded in UTF-8.
                children:
                  - title: String Length
                    length_in_bytes: 1
                    explanation_markdown: |
                      The length of the topic name compact string + 1, represented as an unsigned varint. Here, it is 0x04 (4), indicating that the length of the topic name is 3.
                  - title: String Content
                    length_in_bytes: 3
                    explanation_markdown: |
                      The actual topic name string. In this case, it is "quz" encoded in UTF-8.
              - title: Partition Responses Array
                explanation_markdown: |
                  An array of partition responses for this topic.

                  This array is encoded as a `COMPACT_ARRAY`, which starts with a varint corresponding to the length of the array + 1, followed by each element.
                children:
                  - title: Array Length
                    length_in_bytes: 1
                    explanation_markdown: |
                      The length of the partition array + 1, encoded as an unsigned varint. Here, it is `0x02`, which is `2` in decimal, meaning that the array length is 1.
                  - title: "Partition #1"
                    explanation_markdown: |
                      Information about the first partition.
                    children:
                      - title: Partition ID
                        length_in_bytes: 4
                        explanation_markdown: |
                          A 4-byte integer representing the partition index.

                          Here, it is `0x00000000`, which is `0` in decimal, which corresponds to partition 0.
                      - title: Error Code
                        length_in_bytes: 2
                        explanation_markdown: |
                          A 2-byte integer representing the error code for this partition.

                          Here, it is `0x0003`, which is `3` in decimal, which corresponds to `UNKNOWN_TOPIC_OR_PARTITION`. You can find all error codes [here](https://kafka.apache.org/protocol.html#protocol_error_codes).
                      - title: Base Offset
                        length_in_bytes: 8
                        explanation_markdown: |
                          An 8-byte integer representing the base offset of the batch.

                          Here, it is `0xffffffffffffffff`, which is `-1` in decimal, indicating an error.
                      - title: Log Append Time
                        length_in_bytes: 8
                        explanation_markdown: |
                          An 8-byte integer representing the timestamp assigned to the batch by the broker.

                          Here, it is `0xffffffffffffffff`, which is `-1` in decimal, indicating an error or when the broker is configured with `CreateTime`.
                      - title: Log Start Offset
                        length_in_bytes: 8
                        explanation_markdown: |
                          An 8-byte integer representing the start offset of the log.

                          Here, it is `0xffffffffffffffff`, which is `-1` in decimal, indicating an error.
                      - title: Record Errors Array
                        explanation_markdown: |
                          An array of record-level errors.

                          This array is encoded as a `COMPACT_ARRAY`, which starts with a varint corresponding to the length of the array + 1, followed by each element.
                        children:
                          - title: Array Length
                            length_in_bytes: 1
                            explanation_markdown: |
                              The length of the record errors array + 1, encoded as an unsigned varint. Here, it is `0x01`, which is `1` in decimal, meaning the array length is 0.
                      - title: Error Message
                        length_in_bytes: 1
                        explanation_markdown: |
                          A nullable compact string containing a detailed error message.

                          Here, it is `0x00`, which is `0` in decimal, indicating a null string.
                      - title: Tag Buffer
                        length_in_bytes: 1
                        explanation_markdown: |
                          An empty tagged field array, represented by a single byte of value 0x00.
              - title: Tag Buffer
                length_in_bytes: 1
                explanation_markdown: |
                  An empty tagged field array, represented by a single byte of value 0x00.
      - title: Throttle Time
        length_in_bytes: 4
        explanation_markdown: |
          A 4-byte integer that represents the duration in milliseconds for which the request was throttled due to quota violation.

          Here, it is `0x00000000`, which is `0` in decimal, indicating no throttling.
      - title: Tag Buffer
        length_in_bytes: 1
        explanation_markdown: |
          An empty tagged field array, represented by a single byte of value 0x00.
